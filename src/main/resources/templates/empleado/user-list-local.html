<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport"
	content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<title>Lista usuarios</title>

<!-- Normalize V8.0.1 -->
<link rel="stylesheet" href="../css/normalize.css">

<!-- Bootstrap V4.3 -->
<link rel="stylesheet" href="../css/bootstrap.min.css">

<!-- Bootstrap Material Design V4.0 -->
<link rel="stylesheet" href="../css/bootstrap-material-design.min.css">

<!-- Font Awesome V5.9.0 -->
<link rel="stylesheet" href="../css/all.css">

<!-- Sweet Alerts V8.13.0 CSS file -->
<link rel="stylesheet" href="../css/sweetalert2.min.css">

<!-- Sweet Alert V8.13.0 JS file-->
<script src="../js/sweetalert2.min.js"></script>

<!-- jQuery Custom Content Scroller V3.1.5 -->
<link rel="stylesheet" href="../css/jquery.mCustomScrollbar.css">

<!-- General Styles -->
<link rel="stylesheet" href="../css/style.css">


</head>
<body>

	<!-- Main container -->
	<main class="full-box main-container">
		<!-- Nav lateral -->
		<section class="full-box nav-lateral">
			<div class="full-box nav-lateral-bg show-nav-lateral"></div>
			<div class="full-box nav-lateral-content">
				<figure class="full-box nav-lateral-avatar">
					<i class="far fa-times-circle show-nav-lateral"></i>
					<img src="../assets/avatar/Avatar.png" class="img-fluid"
						alt="Avatar">
					<figcaption class="roboto-medium text-center">
						<td th:text="${usuario}"></td>  <br>
						<small class="roboto-condensed-light">Web Developer</small>
					</figcaption>
				</figure>
				<div class="full-box nav-lateral-bar" th:replace="nav :: nav"></div>
			</div>
		</section>

		<!-- Page content -->
		<section class="full-box page-content">
			<nav class="full-box navbar-info">
				<a href="#" class="float-left show-nav-lateral"> <i
					class="fas fa-exchange-alt"></i>
				</a> <a href="user-update.html"> <i class="fas fa-user-cog"></i>
				</a> <a href="#" class="btn-exit-system"> <i
					class="fas fa-power-off"></i>
				</a>
			</nav>

			<!-- Page header -->
			<div class="full-box page-header">
				<h3 class="text-left">
					<i class="fas fa-clipboard-list fa-fw"></i> &nbsp; LISTA DE
					USUARIOS
				</h3>
				<p class="text-justify">Lorem ipsum dolor sit amet, consectetur
					adipisicing elit. Suscipit nostrum rerum animi natus beatae ex.
					Culpa blanditiis tempore amet alias placeat, obcaecati quaerat
					ullam, sunt est, odio aut veniam ratione.</p>
			</div>

			<div class="container-fluid">
				<ul class="full-box list-unstyled page-nav-tabs">
					<li><a th:href="@{/empleados/new}"><i class="fas fa-plus fa-fw"></i>&nbsp; NUEVO EMPLEADO</a></li>

					<li><a class="active" href="user-list.html"><i
							class="fas fa-clipboard-list fa-fw"></i> &nbsp; LISTA DE EMPLEADOS</a>
					</li> 

					<li><a href="user-search.html"><i class="fas fa-search fa-fw"></i> &nbsp; BUSCAR EMPLEADO</a></li>

					<li>
						<div>
							<!-- Button trigger modal -->
								<button id="bot1" type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModalCenter">
									Calcular Sueldo Total
								</button>
								
								<!-- Modal -->
								<div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
									<div class="modal-dialog modal-dialog-centered" role="document">
										<div class="modal-content">
											<div class="modal-header">
												<h5 class="modal-title" id="exampleModalLongTitle">Sueldo total por empleado</h5>
												<button type="button" class="close" data-dismiss="modal" aria-label="Close">
													<span aria-hidden="true">&times;</span>
												</button>
											</div>
			
											<div th:each="empleado:${empleados}" class="modal-body">
												<div id="cambio"></div>
											</div>
			
											<div class="modal-footer">
											<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
											<button type="button" class="btn btn-primary">Save changes</button>
											</div>
										</div>
									</div>
								</div>
							</div>
					</li>
				</ul>
			</div>

			<!-- Content -->
			<div class="container-fluid">
				<div class="table-responsive">
					<table class="table table-dark table-sm">
						<thead>
							<tr class="text-center roboto-medium">
							
								<th>ID</th>
								<th>DNI</th>
								<th>NOMBRE</th>
								<th>APELLIDO</th>
								<th>FECHA DE NACIMIENTO</th>
								<th>HORARIO DE ENTRADA</th>
								<th>HORARIO DE SALIDA</th>
								<th>TIPO EMPLEADO</th>
								<th>SUELDO</th>
								<th>GERENTE</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="empleado:${empleados}">

								<td id="reemplazo" th:text="${empleado.id}"></td>
								<td th:text="${empleado.dni}"></td>
								<td th:text="${empleado.nombre}"></td>
								<td th:text="${empleado.apellido}"></td>
								<td th:text="${empleado.fechaNacimiento}"></td>
								<td th:text="${empleado.horarioEntrada}"></td>
								<td th:text="${empleado.horarioSalida}"></td>
								<td th:text="${empleado.tipoEmpleado}"></td>
								<td th:text="${empleado.sueldo}"></td>
								<td th:text="${empleado.gerente}"></td>

								<td>
									<a th:href="@{/empleados/editar/{id}(id=${empleado.id})}"
									class="btn btn-success"> <i class="fas fa-sync-alt"></i>
									</a>
								</td>

								<td>
									<a th:href="@{/empleados/eliminar/{id}(id=${empleado.id})}" button
									type="button"
									onclick="alert('El cliente fue eliminado con exito!')"> <i
										class="far fa-trash-alt"></i>
								</a>
							</tr>
						</tbody>
					</table>
				</div>
			</div>

		</section>
	</main>


		<div th:replace="scripts-footer.html"></div>
		<script src="/vendor/jquery/jquery.min.js"></script>
		<script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
		<script type="text/javascript">
			
			$('#bot1').click(function(){//problema solo agarra al primer id, no toma a los otros no elige al seleccionado
					$("#reemplazo").attr("id","empleado-id");
					var localId =  [[${local.id}]];

				$.ajax({ //https://api.jquery.com/jquery.ajax/ => Examples:
					method: "GET",
					url: "/empleados/sueldos/" + localId
				})
				.done(function (result) {	
					var content = result;
					$.each(content, function(index, value) {
						var comision = value.sueldoNuevo - value.sueldo;
						$('#cambio').replaceWith('<div> Empleado =' +value.nombre + '---- Comision=' + comision+ '---- Sueldo Total=' + value.sueldoNuevo + '</div>');
					});
					console.log(content);
				})
				.fail(function() {
					alert("error");
				});
			});
		</script>
</div>

		</section>
	</main>


		<div th:replace="scripts-footer.html"></div>
